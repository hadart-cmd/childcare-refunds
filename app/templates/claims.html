{% extends "base.html" %}
{% block content %}
<h2>Refund Claims</h2>
<table>
  <thead><tr><th>Treatment Date</th><th>Status</th><th>Expected</th><th>Update</th></tr></thead>
  <tbody>
    {% for claim in claims %}
    {% set treatment = treatment_map[claim.treatment_id|string] %}
    <tr>
      <td>{{ treatment.treatment_date }}</td>
      <td>{{ claim.status }}</td>
      <td>${{ '%.2f'|format(claim.expected_refund_amount or 0) }}</td>
      <td>
        <form method="post" action="/claims/{{ claim.id }}" class="inline-form vertical">
          <select name="status">
            {% for st in statuses %}
              <option value="{{ st.value }}" {% if claim.status == st %}selected{% endif %}>{{ st.value }}</option>
            {% endfor %}
          </select>
          <input name="submitted_on" type="date" value="{{ claim.submitted_on or '' }}">
          <input name="received_amount" type="number" step="0.01" min="0" value="{{ claim.received_amount or '' }}" placeholder="Received amount">
          <input name="received_on" type="date" value="{{ claim.received_on or '' }}">
          <input name="reference_number" value="{{ claim.reference_number or '' }}" placeholder="Reference #">
          <input name="notes" value="{{ claim.notes or '' }}" placeholder="Notes">
          <button type="submit">Save</button>
        </form>
      </td>
    </tr>
    {% else %}
    <tr><td colspan="4">No claims yet.</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
